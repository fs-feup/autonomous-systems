<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Formula Student Autonomous Systems: Control Module</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Formula Student Autonomous Systems
   </div>
   <div id="projectbrief">The code for the main driverless system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d7/d97/md_src_2control_2_r_e_a_d_m_e.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Control Module</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md38"></a> </p>
<h1><a class="anchor" id="autotoc_md39"></a>
Package Information</h1>
<h2><a class="anchor" id="autotoc_md40"></a>
Description</h2>
<p>The <a class="el" href="../../d7/d49/class_control.html" title="Class responsible for the control of the car.">Control</a> node uses <a class="el" href="../../d9/db5/class_planning.html" title="Class responsible for planning and path generation for our car.">Planning</a> (pathpoints with expected velocity values) and State Estimation (current vehicle pose) data to effectively calculate longitudinal (torque) and lateral values (steering angle) using <a class="el" href="../../d6/d5a/class_p_i_d.html" title="PI-D Controller class.">PID</a> and Pure Pursuit controllers, respectively.</p>
<h2><a class="anchor" id="autotoc_md41"></a>
Folder Structure</h2>
<ul>
<li><a href="../.././include/adapter_control/">adapter_control</a>: Adapters to change ros2 interfaces according to simulator or environment</li>
<li><a href="../.././include/node_/">node_</a>: Node class and main control class</li>
<li><a href="../.././include/pid/">pid</a>: PI-D controller class, used for longitudinal control</li>
<li><a href="../.././include/point_solver/">point_solver</a>: Point Solver class, used to calculate the reference point for the Pure Pursuit controller and the <a class="el" href="../../d6/d5a/class_p_i_d.html" title="PI-D Controller class.">PID</a> controller</li>
<li><a href="../.././include/pure_pursuit/">pure_pursuit</a>: Pure Pursuit controller class, used for lateral control</li>
</ul>
<h2><a class="anchor" id="autotoc_md42"></a>
Launch Configurations</h2>
<ul>
<li><a href="../.././launch/eufs.launch.py">eufs.launch.py</a>: Launch file for the EUFS simulator</li>
<li><a href="../.././launch/pacsim.launch.py">pacsim.launch.py</a>: Launch file for the PacSim simulator</li>
<li><a href="../.././launch/vehicle.launch.py">vehicle.launch.py</a>: Launch file for the 01 vehicle</li>
</ul>
<h2><a class="anchor" id="autotoc_md43"></a>
Important Dependencies</h2>
<h1><a class="anchor" id="autotoc_md44"></a>
How to Run</h1>
<h2><a class="anchor" id="autotoc_md45"></a>
Install Dependencies</h2>
<div class="fragment"><div class="line">./dependencies_install.sh</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md46"></a>
Compiling</h2>
<div class="fragment"><div class="line">colcon build --packages-up-to control</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md47"></a>
Testing</h2>
<div class="fragment"><div class="line">colcon test --packages-select control # use event-handler=console_direct+ for imediate output</div>
</div><!-- fragment --><p>To check test results: </p><div class="fragment"><div class="line">colcon test-result --all --verbose</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md48"></a>
Running</h2>
<p>Run with ros2 launch. You may select custom parameters for testing such as simulated state estimation or the mocker node. Check the <a href="../.././launch/control.launch.py">launch file</a> for more details. Example:</p>
<div class="fragment"><div class="line">source ./install/setup.bash # If in a new terminal</div>
<div class="line">ros2 launch control control.launch.py &#39;adapter:=pacsim&#39; &#39;use_simulated_se:=true&#39; &#39;mocker_node:=true&#39;</div>
</div><!-- fragment --><p> Using simulated state estimation allows you to independently test control without using the state estimation module, by using information directly from the simulator. The mocker node allows for the same thing but for planning, by using a hand-picked pathpoint array. The lookahead_gain is for tuning purposes.</p>
<h1><a class="anchor" id="autotoc_md49"></a>
Design</h1>
<p>The following class diagram illustrates the structure of the <a class="el" href="../../d7/d49/class_control.html" title="Class responsible for the control of the car.">Control</a> package:</p>
<p><img src="../../../../docs/assets/Control/controlClassDiagram.jpg" alt="Class Diagram" class="inline"/> We have the following classes: <br  />
</p><ul>
<li><a class="el" href="../../d7/d49/class_control.html" title="Class responsible for the control of the car.">Control</a>: The node itself and the main class that initializes the other classes and runs the control callback.</li>
<li>PSolver: The class that receives <a class="el" href="../../d9/db5/class_planning.html" title="Class responsible for planning and path generation for our car.">Planning</a> information and calculates the reference for the controllers.</li>
<li><a class="el" href="../../d6/d5a/class_p_i_d.html" title="PI-D Controller class.">PID</a>: The class that implements the <a class="el" href="../../d6/d5a/class_p_i_d.html" title="PI-D Controller class.">PID</a> controller, for Longitudinal <a class="el" href="../../d7/d49/class_control.html" title="Class responsible for the control of the car.">Control</a>.</li>
<li>PP: The class that implements the Pure Pursuit controller, for Lateral <a class="el" href="../../d7/d49/class_control.html" title="Class responsible for the control of the car.">Control</a>.</li>
<li><a class="el" href="../../d3/d7f/class_adapter.html" title="Class that handles the communication between the SpeedEstimation node and the other nodes in the syst...">Adapter</a>: Provides an interface to correctly subscribe/publish, as well as parse and normalize values as needed by the different simulators we use.</li>
</ul>
<p>The actions taken when the node gets spinning are the following: <img src="../../../../docs/assets/Control/ControlSequenceDiagram.drawio.png" alt="Sequence Diagram" class="inline"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
