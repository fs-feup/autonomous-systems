<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Formula Student Autonomous Systems: Control Module</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Formula Student Autonomous Systems
   </div>
   <div id="projectbrief">The code for the main driverless system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d7/d97/md_src_2control_2_r_e_a_d_m_e.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Control Module</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md38"></a> </p>
<h1><a class="anchor" id="autotoc_md39"></a>
Package Information</h1>
<h2><a class="anchor" id="autotoc_md40"></a>
Description</h2>
<p>The Control node uses <a class="el" href="../../d9/db5/class_planning.html" title="Responsible for path planning and trajectory generation for the autonomous vehicle.">Planning</a> (pathpoints with expected velocity values) and State Estimation (current vehicle pose and velocity) data to calculate longitudinal (throttle) and lateral (steering angle) controls.</p>
<h2><a class="anchor" id="autotoc_md41"></a>
Folder Structure</h2>
<ul>
<li><a href="../.././include/adapter/">adapter</a>: Adapters to change ros2 interfaces according to simulator or environment</li>
<li><a href="../.././include/config/">config</a>: Parameters struct definition, which will be read from the <a href="../../../../config/control/">config</a> folder</li>
<li><a href="../.././include/control_solver/">control_solver</a>: algorithms that calculate both lateral and longitudinal controls (full control solvers)</li>
<li><a href="../.././include/lateral_controller/">lateral_controller</a>: algorithms that calculate lateral control only (steering angle)</li>
<li><a href="../.././include/longitudinal_controller/">longitudinal_controller</a>: algorithms that calculate longitudinal control only (throttle)</li>
<li><a href="../.././include/ros_node/">ros_node</a>: ROS2 Node class</li>
<li><a href="../.././include/utils/">utils</a>: helper functions used in the other folders</li>
</ul>
<h2><a class="anchor" id="autotoc_md42"></a>
Important Dependencies</h2>
<h1><a class="anchor" id="autotoc_md43"></a>
How to Run</h1>
<h2><a class="anchor" id="autotoc_md44"></a>
Install Dependencies</h2>
<div class="fragment"><div class="line">./dependencies_install.sh</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md45"></a>
Compiling</h2>
<div class="fragment"><div class="line">colcon build --packages-up-to control</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md46"></a>
Testing</h2>
<div class="fragment"><div class="line">colcon test --packages-select control # use event-handler=console_direct+ for imediate output</div>
</div><!-- fragment --><p>To check test results: </p><div class="fragment"><div class="line">colcon test-result --all --verbose</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md47"></a>
Running</h2>
<p>Run with ros2 launch. Example:</p>
<div class="fragment"><div class="line">source ./install/setup.bash # If in a new terminal</div>
<div class="line">ros2 launch control control.launch.py</div>
</div><!-- fragment --><p>To configure the node's inputs and environment, use the <a href="../../../../config/global/global_config.yaml">global config file</a>. Using simulated state estimation (use_simulated_se) allows you to independently test control without using the pose estimate from the state estimation module, by using information directly from the simulator. The mocker node allows for the same thing but for planning (use_simulated_planning), by using a hand-picked pathpoint array. To do the same thing for velocities use use_simulated_velocities. To run the node in different environments, use the adapter parameter.</p>
<p>To tune the node's parameters, use the <a href="../../../../config/control/">control node's config file</a> for the environment you're using.</p>
<h1><a class="anchor" id="autotoc_md48"></a>
Design</h1>
<p>The following class diagram illustrates the structure of the Control package:</p>
<p><img src="../../../../docs/assets/Control/control_class_diagram.drawio.png" alt="Class Diagram" class="inline"/></p>
<p>We have the following classes: <br  />
</p><ul>
<li><a class="el" href="../../d6/dc5/class_control_node.html" title="Class responsible for the ROS2 communication of the control module.">ControlNode</a>: The node abstract class itself, from which adapters inherit. This is the main class that initializes the other classes and interacts with ROS2.</li>
<li>Adapters: Provide an interface to correctly subscribe/publish, as well as parse and normalize values as needed by the different simulators we use and for the actual vehicle.</li>
<li><a class="el" href="../../d1/d5f/class_control_solver.html" title="Base class for control solvers, that calculate both lateral and longitudinal control commands.">ControlSolver</a>: The generic controller, from which other full controllers must inherit.</li>
<li><a class="el" href="../../dd/d8f/class_decoupled_controller.html">DecoupledController</a>: The generic decoupled controller, i.e. the lateral and longitudinal controllers work independently of each other.</li>
<li><a class="el" href="../../d7/d69/class_lateral_controller.html" title="Base (abstract) class for lateral control solvers (that calculate steering command)">LateralController</a>: The generic lateral controller, from which other lateral controllers must inherit.</li>
<li><a class="el" href="../../da/ded/class_longitudinal_controller.html" title="Base (abstract) class for longitudinal controllers (the ones that calculate throttle)">LongitudinalController</a>: The generic longitudinal controller, from which other longitudinal controllers must inherit.</li>
<li><a class="el" href="../../d6/d5a/class_p_i_d.html" title="PI-D Controller class.">PID</a>: The class that implements the <a class="el" href="../../d6/d5a/class_p_i_d.html" title="PI-D Controller class.">PID</a> controller, for Longitudinal Control.</li>
<li><a class="el" href="../../dc/dde/class_pure_pursuit.html" title="Pure Pursuit class.">PurePursuit</a>: The class that implements the Pure Pursuit controller, for Lateral Control. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
