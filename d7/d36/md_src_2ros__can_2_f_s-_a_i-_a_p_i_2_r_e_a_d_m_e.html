<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Formula Student Autonomous Systems: README</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Formula Student Autonomous Systems
   </div>
   <div id="projectbrief">The code for the main driverless system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d7/d36/md_src_2ros__can_2_f_s-_a_i-_a_p_i_2_r_e_a_d_m_e.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">README</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><img src="../.././images/FS_Logo.png" alt="" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md43"></a>
FS-AI_API</h1>
<h2><a class="anchor" id="autotoc_md44"></a>
NOTE:</h2>
<h3><a class="anchor" id="autotoc_md45"></a>
This &lt;em&gt;release candidate&lt;/em&gt; of the &lt;strong&gt;FS-AI_API&lt;/strong&gt; repository contains the source code for the 2021 software revision version of the IMechE FS-AI ADS-DV.</h3>
<p>It has been provided as a reference for teams to start implementing their vehicle interface code.</p>
<p>Previously the 2019 interface was provided as a library 'libfs-ai_api_amd64.a' intended for static linking.</p>
<p>Source code for the library is now released under the MIT license so it may be compiled for any Linux architecture and modified if required.</p>
<p>The 2021 FS-AI ADS-DV has an updated CAN interface to support the new vehicle feature of modulated hydraulic brakes. This interface is backward compatible to the 2019 vehicle.</p>
<p>Further work has been done to improve the Console &amp; Tester example programmes.</p>
<h2><a class="anchor" id="autotoc_md46"></a>
Contents</h2>
<div class="fragment"><div class="line">\Docs</div>
<div class="line">    (documentation files)</div>
<div class="line">\FS-AI_API</div>
<div class="line">    (library source code &amp; makefile)</div>
<div class="line">\FS-AI_API_Console</div>
<div class="line">    (Console test programme)</div>
<div class="line">\FS-AI_API_Tester</div>
<div class="line">    (Test programme)</div>
<div class="line">\images</div>
<div class="line">    (images for Markdown files)</div>
</div><!-- fragment --><p>To build:</p>
<p><code>cd FS-AI_API_Tester</code> or <code>cd FS-AI_API_Console</code> <code>make</code> to build (library will build / rebuild as needed).</p>
<p><code>./fs-ai_api_tester vcan0</code> to run on vcan0.</p>
<p><code>./fs-ai_api_tester can0</code> to run on can0, etc.</p>
<p>NOTE: See <code>setup.sh</code> for information on configuring a CAN interface under Linux and the commands to setup can0, vcan0, etc.</p>
<h2><a class="anchor" id="autotoc_md47"></a>
How to use</h2>
<p>The library contains 7 functions plus associated data structures and enums:</p>
<h3><a class="anchor" id="autotoc_md48"></a>
&lt;tt&gt;int fs-ai_api_init(char *CAN_interface, int debug, int simulate);&lt;/tt&gt;</h3>
<p>Accepts a character string referring to an available CAN interface (e.g. can0) and initialises the library.</p>
<p>Setting <code>debug</code> to a non-zero value outputs debugging info to <code>stdout</code> (otherwise the library is silent).</p>
<p>Setting <code>simulate</code> to a non-zero value causes simulated values to be loaded into the data structures.</p>
<p>NOTE: The simulated data is not representative of vehicle operation and simply changes on each call of <code><a class="el" href="../../db/d29/fs-ai__api_8c.html#a51d163f74a40ea6e3ac5d068e84ce0b2">fs_ai_api_vcu2ai_get_data()</a></code>.</p>
<h3><a class="anchor" id="autotoc_md49"></a>
&lt;tt&gt;void fs_ai_api_vcu2ai_get_data(fs_ai_api_vcu2ai *data);&lt;/tt&gt;</h3>
<p>Populates an instance of the <code>fs_ai_api_vcu2ai</code> data structure with the latest values received from the vehicle. Data receives are asynchronous - each CAN frame is buffered as it is received.</p>
<h3><a class="anchor" id="autotoc_md50"></a>
&lt;tt&gt;void fs_ai_api_ai2vcu_set_data(fs_ai_api_ai2vcu *data);&lt;/tt&gt;</h3>
<p>Transmits the CAN frames associated with the data passed in via the <code>fs_ai_api_ai2vcu</code> data structure.</p>
<p>NOTE: This function must be called frequently enough to prevent the CAN timeout diagnostics of the vehicle ECU from triggering. However calling the function too frequently could overload the CAN bus so an internal timer prevents re-transmission of CAN frames at a period less than approx. 8ms. Calling this function every 10ms is optimal, data updates will be sent to the vehicle as fast as possible.</p>
<h3><a class="anchor" id="autotoc_md51"></a>
&lt;tt&gt;void fs_ai_api_imu_get_data(fs_ai_api_imu *data);&lt;/tt&gt;</h3>
<p>Populates an instance of the <code>fs_ai_api_imu</code> data structure with the latest values received from the PCAN-GPS fitted to the vehicle. Data receives are asynchronous - each CAN frame is buffered as it is received.</p>
<h3><a class="anchor" id="autotoc_md52"></a>
&lt;tt&gt;void fs_ai_api_gps_get_data(fs_ai_api_gps *data);&lt;/tt&gt;</h3>
<p>Populates an instance of the <code>fs_ai_api_gps</code> data structure with the latest values received from the PCAN-GPS fitted to the vehicle. Data receives are asynchronous - each CAN frame is buffered as it is received.</p>
<h3><a class="anchor" id="autotoc_md53"></a>
&lt;tt&gt;void fs_ai_api_get_can_stats(can_stats_t *data);&lt;/tt&gt;</h3>
<p>Populates an instance of the <code>can_stats_t</code> data structure with the latest values received from the vehicle. Use this for debugging CAN receives.</p>
<h3><a class="anchor" id="autotoc_md54"></a>
&lt;tt&gt;void fs_ai_api_clear_can_stats();&lt;/tt&gt;</h3>
<p>Clears the <code>can_stats_t</code> data structure.</p>
<h2><a class="anchor" id="autotoc_md55"></a>
autotoc_md55</h2>
<h2><a class="anchor" id="autotoc_md56"></a>
Further Documentation</h2>
<p>Please refer to the full specification document for full information on the FS-AI ADS-DV CAN interface: <a href="../.././Docs/ADS-DV_Software_Interface_Specification_v4.0.pdf">ADS-DV Software Interface Specification-v4.0.pdf</a>.</p>
<p>(also published on the IMechE website as: <a href="https://www.imeche.org/docs/default-source/1-oscar/formula-student/2021/forms/ai/ads-dv-software-interface-specification-v4-0.pdf?sfvrsn=2">https://www.imeche.org/docs/default-source/1-oscar/formula-student/2021/forms/ai/ads-dv-software-interface-specification-v4-0.pdf?sfvrsn=2</a> ).</p>
<p>The referenced CAN database can be found here: <a href="../.././Docs/ADSDV_2021_VCU_AI_interface_v2.dbc">ADSDV_2021_VCU_AI_interface_v2.dbc</a>.</p>
<p>This software library exposes only those aspects of the full interface that are deemed essential for the 2021 Formula Student AI DDT competition using the FS-AI ADS-DV. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
