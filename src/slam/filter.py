import re


def out_of_square(x1, x2, y1, y2, point_x, point_y):
    return point_x < x1 or point_x > x2 or point_y < y1 or point_y > y2


def parse_cones(cones_str):
    """Parses a string of cones into a list of tuples."""
    pattern = r"\((-?\d+\.?\d*),\s*(-?\d+\.?\d*)\)"
    matches = re.findall(pattern, cones_str)
    return [(float(x), float(y)) for x, y in matches]


def format_cones(cones):
    """Formats a list of tuples into a string of cones."""
    return ", ".join(f"({x}, {y})" for x, y in cones)


def filter_cones(cones_str, func):
    """Filters cones based on a given function."""
    cones = parse_cones(cones_str)
    filtered_cones = [cone for cone in cones if func(cone)]
    return format_cones(filtered_cones)


# Example function to apply to each cone
def example_function(cone):
    x, y = cone
    return (
        y < 54.6
        and x > -20
        and y < -x + 85
        and out_of_square(1, 10, -10, -3, x, y)
        and out_of_square(0, 17, 4, 15, x, y)
        and out_of_square(-10, -8, 34, 36, x, y)
        and out_of_square(34, 38, -28, -24, x, y)
    )  # Example: Keep cones in the first quadrant


if __name__ == "__main__":
    # Input string of cones
    cones_input = "(5.133865045963249, -1.396701762002485), (8.150394376338124, 4.396929969323597), (7.507541529715111, 6.55421565419266), (7.0138673910730995, 7.126181144785143), (1.6594067280773526, 1.8983275415207055), (13.954832424600028, 1.5581381945701365), (5.109304321488534, 1.9307505888394678), (13.939580891057874, -1.765110066320399), (8.777965014771125, 9.207167508105082), (17.336048082575516, 1.7509525045482113), (7.341673985715374, 4.085977161814296), (6.7341480471727495, 11.035330999406892), (17.69898569832601, -1.7187114525920022), (1.2866748571395876, -3.268325090408325), (1.9046559333801265, -5.030924320220947), (8.701283026797377, -6.5442377399450296), (7.785508584377511, -5.858026238328338), (8.499558817500564, 2.3616694690999065), (8.556268542437962, -1.2401039035378258), (1.7106933593750004, -4.648070812225342), (8.515992492799429, 7.9378852066624495), (6.62365200570483, 5.386406808794455), (6.937982407410768, -4.100037945389506), (3.5490245819091797, -6.36557674407959), (7.3786004683902275, 5.078552820271427), (2.0693910121917725, -6.143548488616943), (7.869848477627094, -3.918360129393276), (2.9646904468536377, -9.015334129333496), (10.215872084446476, 12.301624413437533), (2.135297298431397, -6.922608375549316), (9.117102701902088, 2.1574683773703054), (6.242768370541822, -1.182427759834908), (6.375254988765949, 2.219451650728613), (8.820065397317203, 13.756766981367791), (8.845985811589765, -1.1417360421039597), (11.673796482687385, 14.588644256554112), (0.06523650139570236, 4.391510486602783), (9.515140312051573, 4.763438605516055), (1.0190100669860844, 7.838854789733887), (0.6963430285647306, 10.224481471359173), (1.1230174303054818, 9.873774528503418), (3.714826822280883, 10.09099292755127), (2.461215257644654, 10.937617301940918), (6.933457795726114, 11.034366139006938), (2.8608372211456303, 11.418395042419434), (7.237996840364944, 11.875639312445458), (21.389288006241067, 1.6259677215598272), (3.169143023337582, -1.0984654617088352), (21.67373532803474, -1.8342692908291565), (12.41375362496421, -17.701235257685212), (23.80649851294385, 1.9961197784805202), (8.387278698780934, -19.82514652935703), (16.466041046486477, -15.749880953362206), (7.473977412119347, 9.680288587077092), (25.15272092520826, -1.294028009328845), (25.67218001855477, 2.880894551945877), (20.555358426136493, -13.768614097495659), (14.326710954503312, 11.69964504500021), (14.790364276288901, 11.8711901541223), (27.27019783731637, 5.0209375319470855), (28.041716387829606, 0.2878611391680058), (24.56597885677178, -11.75556417741298), (29.346863131841967, 1.6518315205796044), (28.491140585231452, 7.911089016845398), (30.405283878935066, 3.4683791678749563), (18.360601041502743, -18.725990167911974), (26.56613227031285, 11.71889879708702), (28.47078599088699, -9.65345254289306), (21.705684370962377, -17.807561737015618), (28.00318146403647, 10.21948173173525), (24.374923779113043, 14.873201856971892), (31.338837746250817, 5.333937231726506), (26.31917602993796, -14.939705782518173), (14.321481956710834, -20.746608049727364), (16.338061019635973, 13.927701709540445), (32.08211958702466, 7.622306710727417), (31.45766926687491, 11.182466407163043), (30.3792433092678, -12.702264583123213), (32.349674799848344, -7.689711950950968), (29.27917880423643, 14.007778726755369), (27.846587647616893, 18.071618209367053), (16.321321692491505, -14.054197905899159), (36.33817418465225, -5.5577223088373735), (34.51310761863657, -10.72797634049117), (27.269728340573376, 18.67588947367759), (39.22390207049575, -4.059875751166881), (38.382822020111, -8.541536484226961), (41.658263200344514, -2.0592568521214596), (41.68668338052126, -6.59924450802764), (44.89475662479599, 1.595655248295124), (44.57272073175528, -4.324195693744487), (27.093940740889828, 20.856749654672793), (23.511018858327148, 18.57312358602521), (23.991009958088064, 21.65021479003698), (47.73711590444538, -0.6661040100537104), (47.94592914548282, 5.233960954232499), (28.56432352675873, 24.034801223864864), (25.767816608301978, 23.99050600809743), (49.68475805962337, 8.664221623300827), (29.070597441025804, 26.14090555092508), (15.68187215583812, 11.835347200287291), (16.150744399598715, 14.468426001860827), (26.20764813930816, 26.63915068025201), (11.61856488729895, 12.560450607006688), (50.620939739603415, 12.11590187737678), (12.86917078820009, 11.482728713056295), (9.035938132700014, 14.41719044472456), (15.701127408019664, 11.91920204164253), (29.12529000365888, 28.054583962273266), (28.413796456845212, 29.943980377661013), (24.64581836170292, 29.3671324786939), (22.391240507985614, 31.72380336336962), (27.12028355799802, 32.032965884772324), (20.145781556688224, 32.507167010631626), (10.899033171105245, 12.810527640856153), (24.52734685938393, 34.37856741143578), (17.30329357266592, 32.973665946236416), (8.664012598469116, 11.078649232775945), (14.647117870934235, 32.90367216593822), (21.2564885543144, 35.8263024966574), (10.353446223956588, 30.73669689539158), (7.572353485705365, 28.011593699451037), (17.971174893749374, 36.48881312709552), (39.214484996681215, 32.92129544583579), (36.880789292782204, 35.365097768017634), (13.865098340596449, 36.43314365917138), (35.55755622739879, 37.77241547335112), (10.560367840196811, 34.986537613499486), (7.972670697829389, 32.878939322078494), (43.61806833514687, 31.179871424064277), (34.32424589431214, 39.861798049066834), (40.902095534914864, 36.320759307197015), (32.461890807890555, 41.81318335207229), (40.02222103556055, 37.57153216158989), (28.700812455116793, 44.033428725618684), (39.139916439028795, 39.05656122114261), (37.58753907093727, 42.30095582027956), (45.24117491589451, 34.19539021711514), (34.21458313986115, 44.8210719361951), (25.178833335956053, 45.63893945264385), (47.737971866726504, 29.19493942593751), (30.48297865757543, 47.202647731314165), (27.031931465735983, 49.194295133961845), (20.69539070346434, 47.898925347389806), (5.198965806240795, 30.71857352128267), (22.38178083860276, 51.28020264304174), (17.03682359553006, 49.79274041490877), (18.983596034892134, 52.81482728352454), (13.447904245461386, 50.76678169421903), (2.067033862520838, 29.13427574861846), (16.954656978152148, 53.64511528402545), (3.86541500362824, 26.293985347883496), (9.507662469489295, 50.64812414475607), (14.22532623610337, 54.57442513456554), (-1.154290295500072, 27.735417443197505), (4.613555010110206, 50.1512683996718), (0.5912690220888993, 24.67280726942949), (9.111454228796589, 54.202009490352935), (0.48974819327880253, 48.51822376244287), (-4.103946111534365, 27.193762293553963), (-3.098974067645431, 46.502709235671176), (-3.191538790232285, 23.654117493275436), (4.313431310146983, 53.58408495486383), (-6.849335915337426, 44.03194005508362), (16.692776151939604, 14.040560048787096), (-7.2846295351323045, 26.26613653409632), (9.37507462467686, 13.959012648689647), (-7.170722384429113, 22.72439985939919), (-10.300807911105686, 26.386068787584513), (-12.232869396958996, 26.868963374765602), (-10.982405908087513, 22.97519322699486), (-8.573946630523409, 34.29283732787203), (-13.726353980976043, 27.63314577080668), (7.606199112136151, 13.227388977984026), (7.190866066867164, 11.238025806780856), (-12.062027140140508, 38.84414244306795), (-13.434132324522908, 23.519952269127007), (-15.875116677160051, 29.483154478389633), (-9.331095618392784, 41.43955261312478), (-13.501631207792256, 36.25657017803633), (-15.03764680622806, 33.933756488208836), (-16.049453599375866, 31.88012019702476), (-15.50202481462491, 24.645703589334495), (-17.32003764868317, 25.673018538011366), (-19.307190133687367, 28.22486129016517), (-19.572473299892145, 30.428120314107343), (-19.294161259789057, 32.81627609481811), (-14.50147902849382, 41.38844224963543), (-18.26297933722667, 35.449411372148234), (-16.491157060518564, 38.36343825256624), (-11.647212548847197, 44.19968968769584), (-24.74965239100087, 24.042615090361895), (-24.754081373769793, 24.060399449743706), (-24.807976871025133, 24.710831511201707), (-25.229166958246136, 27.186207594398347), (-24.04040668382405, 21.26988176834007), (-23.88039584980375, 19.650121633924257), (-24.54704052418019, 22.921813470159126), (-24.621862741972468, 22.372627926047958), (-30.083910302497035, 25.614472932795465), (-30.95460005144855, 19.568166839661277), (-29.763428316308666, 19.028630973194776), (-24.099714359009372, 20.9926515830559), (-24.24641429542718, 21.656405658994444), (-33.1813678835114, 25.684489228084356), (-23.626658699651443, 17.87454978984368), (-30.084020657226247, 24.507674716232675), (-25.494511913511246, 25.782954639956095), (-24.05715461703155, 20.281185289350283), (-31.14696776440177, 24.278244591562753), (-34.62154485499049, 27.3436999596171), (-34.25058002666488, 22.449821523569884), (-34.58183679212763, 27.296401817012363), (-28.85521425685762, 27.42456499528255), (-8.944542691983884, 47.08762936056697), (-33.18995664402135, 28.24525227987256), (-34.74442727206589, 27.397927584617186), (-32.956422411468694, 27.51150414652451), (-11.765303689099271, 44.21650895668713), (-4.825187560842522, 49.713970275569196), (-0.5268312118643621, 51.94179440642197), (-11.824836138404875, 61.64803922821591), (-13.074259664556008, 60.50502625676922), (-11.75769116198369, 61.680638234652996), (-14.035131287248086, 58.08480957504691), (-17.207818912199976, 61.567688075887325), (-12.13992045974416, 61.507196624240905), (-18.31004485417663, 59.89010685822445), (-13.992618549204517, 60.462037398335525), (-20.040252524834305, 59.816224780698555), (-5.168275081873133, 59.559354673749716), (-3.6473147147790557, 59.71936125615955), (-11.139765159519731, 62.08030013198797), (0.36411439965212866, 64.13313110854206), (-6.855585748884201, 61.283433817407726), (5.815730108807231, 61.579237113752455), (-3.4223448343617977, 61.657426491717196), (-5.228060825847186, 63.71583634429297), (8.107809999352446, 63.363563778038355), (-4.918937284678855, 63.60756581074941), (-7.269312318399131, 63.170190194424045), (1.3761089654662388, 63.40164887061199), (-2.3693209371222395, 69.58956281093444), (-0.6138479969863887, 62.2060365544421), (12.010803885499255, 63.545684726716104), (13.415194373125107, 63.780300650830185), (2.2229770634308905, 67.69546799715783), (1.0011051788603134, 63.70383989628818), (7.322316154475033, 68.00849641148149), (10.338272071089643, 63.75316755596953), (8.155375409528594, 63.1973248353007), (-1.3509451497657499, 62.004254042012114), (12.365415042652323, 63.68303222101902), (-2.0275807810123267, 61.84303707583667), (10.690248654699344, 63.727197598769926), (3.27296153671594, 62.1383552677324), (14.7237911160973, 63.473929611031394), (16.371839846026454, 66.16736489029176), (17.130627778064998, 63.618941263445784), (9.172137093625395, 70.09188246399283), (4.817951350940659, 72.64988070869079), (0.15558632529066937, 66.97893513865009), (16.45364746427244, 64.59753085981382), (19.9130795866411, 62.90064670659457), (21.90112101553024, 64.23712345110026), (2.950299931199463, 72.8566729293821), (5.437508017415144, 71.40082410743473), (16.928716176608006, 63.73184871567589), (6.610810880151912, 68.21939412075733), (7.122934156375438, 70.44441578196205), (25.81334488653737, 62.2289793711972), (23.295162630343093, 61.65493765381369), (18.203289502135174, 65.99307884649929), (21.92302306235335, 61.837992924378895), (20.56016973737321, 65.71715277993009), (22.114797771285932, 63.42447464909701), (20.119239230534323, 62.328794768567015), (12.323097442726919, 64.3793536871934), (29.053840519009917, 59.93132688488009), (25.82334689368173, 62.14985916978153), (17.44538282255066, 63.470511755178876), (18.468847009447412, 64.16061098775792), (18.60830270294003, 63.05768364821974), (23.21485848654005, 63.03755262237431), (21.2146186398873, 62.459937557894385), (19.332713641805352, 62.81740136207013), (21.30725022847026, 65.43862329630292), (25.655195704900596, 63.93968475929602), (32.47613222571047, 59.067514078356446), (24.748478742736594, 71.2607184280351), (28.37565889142019, 65.14529239001641), (25.843759819777524, 61.777817193008914), (33.594181222653326, 58.612457112271066), (35.85404351844386, 58.37561782973586), (30.850933241076607, 60.07213083967107), (31.162865714124642, 66.38324559371792), (37.48857666983119, 58.20380593670826), (35.40154589297177, 59.853905319169144), (30.977057402029267, 66.66553289395678), (40.408887437662116, 56.25600111399828), (37.57736089881333, 56.628798123332736), (42.39818558652728, 58.536242277274944), (44.97185108422949, 54.56454362836075), (49.10267254384972, 49.424433221552185), (49.69609425936593, 50.821843383707844), (46.98810767722776, 50.95198199810688), (48.8865273742701, 49.66921567673891), (50.96702560012701, 45.21125475247331), (49.10522651444543, 48.667755110715426), (48.479119278523285, 49.059324666412216), (48.286130952225676, 52.390401770806065), (48.538890141344055, 52.159443502930124), (43.853410993606815, 56.21724602047844), (42.443562634356766, 58.486777119572245), (49.3663404166257, 32.3185760547772), (43.35023803798019, 56.34639622664968), (53.15840329037428, 44.23375218567182), (50.970478033579134, 51.59969537133373), (49.52769422034311, 27.30359940529099), (51.77586942324316, 50.52129856761573), (51.78225870252513, 29.960035551352533), (53.39025213537315, 48.04422377716467), (54.64527916616737, 42.882182676871125), (55.53597665966326, 36.97865472714537), (51.42957429763884, 25.20563233777781), (53.289200089493875, 44.169485273832215), (54.1851320672781, 39.53525748129252), (55.71020165024287, 38.37537925251937), (54.59114347129899, 35.37880360888193), (54.545022114645946, 26.87978357377446), (59.06952821668677, 38.38817347138983), (60.03795330230355, 39.18709034538995), (52.85502099239155, 22.701238910229296), (58.52245832912942, 39.23299612951126), (56.003335578323416, 24.790311192580084), (54.001235466584404, 18.679249348494384), (53.93422536336323, 19.961937157173615), (56.00913845661823, 35.465234483582), (57.04912372217787, 22.224526030989374), (53.42460081977955, 43.066240393623026), (55.63675307621072, 36.88938806432734), (53.330938024269706, 41.877504055372825), (52.524352377202, 16.307776065147216), (53.52757407425636, 18.219515074482032), (56.41264806205525, 40.15563721003793), (53.646243451108866, 43.24114924268826), (53.77337594531108, 21.070513493925933), (51.57787251978501, 14.494749024092343), (62.16652270486196, 42.213749090909246), (56.83271420992422, 17.613435629755777), (53.28441312967356, 43.733379409960996), (52.14964712043365, 38.865631164505935), (57.670119637375244, 20.041434596769495), (53.93275706879365, 19.949040708839558), (58.213420691018186, 36.468847913478804), (55.81169053366539, 15.247360400761522), (58.23976042373917, 42.47300920099173), (59.33185392504174, 42.4980427938093), (62.54725350618435, 43.03137736955724), (54.893164845903556, 13.045646552545303), (56.601664053149946, 33.521797223616744), (61.983485825449705, 42.4863658080638), (54.08746891787395, 10.946295923727913), (56.42752011473155, 36.32937718889706), (60.44998846490208, 41.26256453164846), (60.65021341861666, 42.704577479019136), (62.282915956592184, 43.44974767235651), (58.53483294267507, 38.58447718178572), (57.68401745573523, 34.87818364117225), (52.88117435522763, 7.22027763272623), (51.09990850274246, 3.2218714717358052), (52.874294592159096, 7.170118999055749), (36.764982681856715, -25.65667195883123), (34.57990648825922, -26.556680596879723), (10.131373799805361, -22.880205825543595), (6.257104828000744, -24.751903209448468), (4.376811055394523, -21.845676416378517), (2.1823272503167015, -26.713408934035602), (0.6510082579812896, -23.534111103174506), (-1.9826467581450464, -28.366699318222942), (-3.5876164681318827, -25.06343240526348), (-7.5999018934218805, -26.36076545388385), (-7.10206702107789, -29.87933170985985), (-11.004265166126034, -26.718004332794496), (-10.952808547999528, -30.280399588741638), (5.985102635345497, -20.021169760578438), (-13.053916903105465, -26.110539542342465), (-12.970625653869757, -29.877290373076903), (-14.536410076026018, -29.27859663583831), (-15.091579614793808, -24.754607772003133), (-15.530706570168343, -22.063720932862847), (-15.42516349643984, -19.066943901199824), (-15.011534449424701, -15.51913462926915), (-16.50187059459203, -28.015809710028496), (-13.881107604531081, -12.093073107314204), (-19.083142163223837, -22.32136148422819), (-18.728281323528762, -24.251186583347533), (-19.013926725973157, -18.692607761873216), (-12.145672002596209, -9.001027291727171), (-18.171787530275047, -26.25245094133307), (-18.58099285726915, -14.788858389019197), (-19.46163923538582, -25.907685663467955), (-1.2511192772237458, -41.17112536801288), (-17.098570901470286, -10.655078727314466), (-15.400039389881137, -7.058873548084523), (-9.841363600539747, -5.7317509649732905), (-12.685220885395752, -3.536559557580313), (-6.901599357884838, -3.254962737017922), (-9.048161831977438, -0.5171521389053673), (-3.932941786010416, -2.0436352666004924), (-5.072080214319033, 1.2535919107821611), (-0.5722046181447417, -1.3587974076191134), (-1.0530786978574391, 1.913300994600631), (2.849396103949815, 2.3963414615030305), (8.73676954184654, -6.098085217279349), (9.017620651895639, 2.316904916204258), (8.677602694142958, -5.815105705791338), (9.847699467491228, 4.305371319197578), (8.616247329210317, 5.69540730143379), (8.174300046586453, 6.850666284017858), (8.503640305028735, -6.106544966837621), (9.046474323383606, 6.3886013434655675), (8.747846131741463, -3.949753875007005), (8.761647123083304, -4.750762568753117), (9.432986815914386, -5.02427533382048), (14.07613112663869, 7.063685080922056)"

    # Apply filter
    result = filter_cones(cones_input, example_function)

    # Print result
    print(result)
