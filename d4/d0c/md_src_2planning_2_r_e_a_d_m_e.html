<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Formula Student Autonomous Systems: Planning Module</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Formula Student Autonomous Systems
   </div>
   <div id="projectbrief">The code for the main driverless system</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d4/d0c/md_src_2planning_2_r_e_a_d_m_e.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Planning Module</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md50"></a> The planning module is the third main module in the autonomous system. It comes after the Localization and Mapping processing and precedes the Control module. It is responsible for processing the cones information(position and color) and to calculate the best path for the car to follow considering the received track. It then sends the desired path to the control in the form of a ordered position sequence.</p>
<h1><a class="anchor" id="autotoc_md51"></a>
Run the Node</h1>
<h2><a class="anchor" id="autotoc_md52"></a>
Install Dependencies</h2>
<p>You will need CGAL library for the Delaunay Triangulations. GSL library for the splines.</p>
<div class="fragment"><div class="line">sudo apt-get install libcgal-dev</div>
<div class="line">sudo apt-get install libgsl-dev</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md53"></a>
Compile</h2>
<div class="fragment"><div class="line">colcon build --packages-select planning custom_interfaces</div>
</div><!-- fragment --> <h2><a class="anchor" id="autotoc_md54"></a>
Source</h2>
<div class="fragment"><div class="line">source ./install/setup.bash</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md55"></a>
Run</h2>
<div class="fragment"><div class="line">ros2 run planning planning</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md56"></a>
Test</h2>
<p>A) You can either run with colcon test. </p><div class="fragment"><div class="line">colcon test --packages-select planning --event-handler=console_direct+</div>
</div><!-- fragment --><p> B) Or you can run using the test executable, after compiling. </p><div class="fragment"><div class="line">ros2 run planning planning_test</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md57"></a>
Design</h1>
<p>The architecture of the module may be described according to the following diagrams.</p>
<h2><a class="anchor" id="autotoc_md58"></a>
Class Diagram</h2>
<p>This diagram will focus on the main classes and instances inside the planning module, mentioning only the core units and most important functions.</p>
<p><img src="../../../../docs/assets/Planning/ClassDiagram.png" alt="" class="inline"/> </p>
<ul>
<li><b>ROS Node:</b> Serves as the fundamental structure and operational backbone of the system.</li>
<li><b><a class="el" href="../../d9/db5/class_planning.html" title="Class responsible for planning and path generation for our car.">Planning</a>:</b> It is the main orchestrator behind all the processes. It is responsible for the communication with other nodes. It contains an <a class="el" href="../../d3/d7f/class_adapter.html" title="Adapter class for coordinating communication between different modes and LateralControl module.">Adapter</a> instance to manage information from the car/simulator and a <a class="el" href="../../d3/da1/class_local_path_planner.html" title="LocalPathPlanner class for generating local paths.">LocalPathPlanner</a> that will be responsible for the path calculation.</li>
<li><b><a class="el" href="../../d3/da1/class_local_path_planner.html" title="LocalPathPlanner class for generating local paths.">LocalPathPlanner</a>:</b> This component is responsible for calculation the desired path. It takes the information from the track and using that it creates a sequence of points within the track boundaries for the control module to use as a reference later on.</li>
<li><b><a class="el" href="../../d6/d2c/class_track.html">Track</a>:</b> This component assembles the information received by the track map, splitting and organizing the different colors and cones. It can also validate the received cones using splines to evaluate the distance between one cone and the trend in its side of the track.</li>
<li><b><a class="el" href="../../d8/da1/class_cone.html">Cone</a>:</b> Basic unit that will fill the track instance. Contains its coordinates, color and id, which will be useful to identify it.</li>
<li><b>PlanningAdapter:</b> Implementation of the <a class="el" href="../../d3/d7f/class_adapter.html" title="Adapter class for coordinating communication between different modes and LateralControl module.">Adapter</a> Pattern. It is an abstraction layer that's used to receive and interact with the car or simulator, depending on the current usage. It can be used for example to control the current event or the car state.</li>
</ul>
<h2><a class="anchor" id="autotoc_md59"></a>
Sequence Diagram</h2>
<p>The planning module receives the track map(a cone array) from the Localization and Mapping block. The main module receives it and will send it to the <a class="el" href="../../d6/d2c/class_track.html">Track</a> instance to fill itself and validates the data using splines. After this step it will transmit the track to the Local Path Planner, which will calculate the ideal path and return it, finally to the main module again. The path is then forwarded to the subsequent node Control.</p>
<p><img src="../../../../docs/assets/Planning/SequenceDiagram.png" alt="" class="inline"/> </p>
<h2><a class="anchor" id="autotoc_md60"></a>
Activity Diagram</h2>
<p>The planning module doesn't have many different flows. The main one to notice is the difference in the action depending on the event. Since for the Skidpad and Acceleration Events, the best path is already calculated, the module will just go find that data and send it. If we are not in the presence of those, the flow will follow just like previously mentioned.</p>
<p><img src="../../../../docs/assets/Planning/ActivityDiagram.png" alt="" style="width: 50%; height: auto;" class="inline"/> </p>
<h1><a class="anchor" id="autotoc_md61"></a>
Full Documentation</h1>
<p>A more precise information about the <a class="el" href="../../d9/db5/class_planning.html" title="Class responsible for planning and path generation for our car.">Planning</a> Module can be found <a href="https://www.overleaf.com">here</a></p>
<p>TODO: CHECK THIS</p>
<h1><a class="anchor" id="autotoc_md62"></a>
Main External Libraries</h1>
<ol type="1">
<li><a href="https://docs.ros.org/en/foxy/index.html">ROS</a></li>
<li><a href="https://www.cgal.org/">CGAL</a></li>
<li><a href="https://www.gnu.org/software/gsl/">GSL</a> </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
